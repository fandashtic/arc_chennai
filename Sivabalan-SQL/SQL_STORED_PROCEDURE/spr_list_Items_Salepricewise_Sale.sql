CREATE PROCEDURE [dbo].[spr_list_Items_Salepricewise_Sale]      (    @FROMDATE datetime,                    @TODATE datetime,                       @PaymentMode nVarchar(50)   )    AS      SELECT distinct InvoiceDetail.Product_Code,   "Category" = Brand.BrandName,   "Item Code" = InvoiceDetail.Product_Code,   "Item Name" = Items.ProductName,    "Sale Price" = InvoiceDetail.SalePrice * Items.ReportingUnit,   "Quantity" = SUM( InvoiceDetail.Quantity / Items.ReportingUnit),   "Gross Amount(%c)"= (InvoiceDetail.SalePrice * Items.ReportingUnit)*(SUM( InvoiceDetail.Quantity / Items.ReportingUnit)),   "Discount(%c)"=Sum(IsNull(InvoiceDetail.SCHEMEDISCAMOUNT, 0) + IsNull(InvoiceDetail.SPLCATDISCAMOUNT, 0)),   "SCP%(%c)"=Sum(IsNull(InvoiceDetail.DiscountValue, 0) - (IsNull(InvoiceDetail.SCHEMEDISCAMOUNT, 0) +    IsNull(InvoiceDetail.SPLCATDISCAMOUNT, 0))),   --"Discount Value" = SUM(InvoiceDetail.DiscountValue),   
"Sales Tax Value(%c)" = Isnull(Sum(InvoiceDetail.STPayable + InvoiceDetail.CSTPayable), 0) ,    "Total(%c)" = Round(SUM(InvoiceDetail.Amount),2)    FROM InvoiceDetail,Items ,Brand    WHERE InvoiceDetail.Product_Code = Items.Product_Code And   InvoiceDetail.InvoiceID IN    (Select InvoiceAbstract.InvoiceID from InvoiceAbstract    where InvoiceAbstract.InvoiceDate BETWEEN @FROMDATE AND @TODATE AND   InvoiceAbstract.PaymentMode IN  (Select Paymentterm.mode from Paymentterm where Paymentterm.value like @PaymentMode) And    (InvoiceAbstract.Status & 128) = 0 AND   InvoiceAbstract.InvoiceType in (1,3)) AND   Items.BrandID = Brand.BrandID       GROUP BY Brand.BrandName,InvoiceDetail.Product_Code, Items.ProductName,InvoiceDetail.SalePrice,Items.ReportingUnit,InvoiceDetail.SalePrice   order by Brand.BrandName
